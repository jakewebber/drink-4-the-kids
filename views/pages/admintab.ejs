
<!DOCTYPE html>
<html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<head>
  <%- include ("../partials/header.ejs") %>
</head>
<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

<script>
</script>

<body class="admin">

<%- include ("../partials/nav.ejs") %>

<%- include ("../partials/admin-nav.ejs",  {page: "tab"}); %>

<div class="tab-content bg-dark">
<!-- BAR TAB ---------------------------------------------->
    <div id="bartab">
      <table class="table table-striped table-bordered table-dark" data-toggle="table" data-flat="true" data-search="true" >
        <thead class="thead-dark">
          <tr>
              <th data-field="" data-sortable="true">Name</th>
              <th data-field="" data-sortable="true">Total Drinks</th>
              <th data-field="" data-sortable="true">Total Cost</th>
              <th data-field="" data-sortable="true">Unpaid </th>
              <th data-field="" data-sortable="true"></th>
          </tr>
        </thead>
        <tbody>
          <% var count = 0; %>
          <% results.forEach((order)=>{  %>
            <tr id="order-id-<%=count%>" data-index="<%= count %>">
              <td><%= order.name %></td>
              <td><%= order.total_drinks %> </td>
              <td>$<%= order.total_cost %> </td>
              <td>$<%= order.unpaid_cost %> </td>
              <td>
              <form id="done-<%=count%>" method="POST" onsubmit="setTimeout(function () { window.location.reload(); }, 50)" action="/closeBarTab" target="dummyframe">
                <input type="hidden" name="barTabName" value="<%=order.name%>" />
                <button class="btn btn-success <%= order.unpaid_cost == 0 ? 'disabled btn-outline-primary' : '' %>" type="submit">Pay Tab</button>
              </form>
            </td>
          </tr>
          <% }) %>
          
        </tbody>
      </table>
      </div>
    <iframe name="dummyframe" id="dummyframe" style="display: none;"></iframe>

    </div>
</body>
</html>
<script type="text/javascript">
  // Select all checkboxes with the name 'settings' using querySelectorAll.
  //  $('form').each((index, form) => {
  //     form.addEventListener('submit', function(e) {
  //       e.preventDefault();
  //       var formData = new FormData();
  //       formData.append(form[0].name, form[0].value)

  //       $.ajax({
  //           url: form.action,
  //           type: 'POST',
  //           data: formData,
  //           success: function (data) {
  //             console.log('done')
  //               alert(data)
  //           },
  //           cache: false,
  //           contentType: false,
  //           processData: false
  //       });
  //     });
  // });
</script>