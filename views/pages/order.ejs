<!DOCTYPE html>
<html>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <head>
        <%- include ("../partials/header.ejs") %>
    </head>
<script type="text/javascript">
  let selectedId = new URLSearchParams(window.location.search).get('id');
  var result;

  $(document).ready(function () {
    if(selectedId){
      $.getJSON("/assets/drinks.json", function (result) {
          var drink = result.find(x=> x.id == selectedId);
          document.getElementById("drink-input").value = drink.name;
      });
    }

    $.getJSON("/assets/drinks.json", function (result) {
      var options = $("#drink-selector");
      result.forEach((item) => {
          options.append(new Option(item.name, item.id));
      });
    });

    var savedName = localStorage.getItem('name');
    if(savedName){
      document.getElementById("name-input").value = savedName;
    }
  });
</script>



<body>

<%- include ("../partials/nav.ejs") %>

<div class="container-fluid mb-5 pb-4">
<h1 class="title pt-2">Order</h1>
<form id="orderform" action="/send" method="POST">
  <fieldset>
    <div class="col-xs-6 col-xl-12">
        <div class="mb-3">
            <label for="drink-input" class="form-label">Drink Order</label>
            <!-- <input id="drink-input" class="form-control form-control-lg" type="text" name="drink" maxlength="25" oninput="this.setCustomValidity('')" oninvalid="this.setCustomValidity('Not even a glass of milk?')"  placeholder="make it good" required/> -->
            <select required id="drink-selector" class="form-select form-select-lg mb-3" placeholder="asdf" required oninput="this.setCustomValidity('')" oninvalid="this.setCustomValidity('Not even a glass of milk?')"  placeholder="make it good">
              <option class="d-none" disabled selected value> Pick a Drink </option>
            </select>
        </div>
      <div class="mb-3">
          <label for="name-input" class="form-label">Your Name</label>
        <input id="name-input" class="form-control form-control-lg" type="text" maxlength="25" name="name" oninput="this.setCustomValidity('')" oninvalid="this.setCustomValidity('We\'ll need your name, nutcracker')" placeholder="buddy the elf?" required/>
      </div>
      <!-- field for bots -->
      <div class="mb-3 d-none">
        <label for="email-input" class="form-label">Email</label>
        <input id="email-input" class="form-control form-control-lg" type="text" maxlength="25" name="email" />
      </div>

      <div class="mb-3">
        <label for="comment-input" class="form-label">Comments</label>
        <textarea  id="comment-input" class="form-control" id="exampleFormControlTextarea1" name="comments" placeholder="write us love letters" rows="2"></textarea>
      </div>
      <div class="d-flex justify-content-center">
      <button class="xmas-button green" type="button" onclick="verifyOrder();" value="Order some shit">Grab a Drink</button>
    </div>
    </div>
  </fieldset>
</form>
<img class="buddy-the-elf"  src="/images/buddytheelf.png">
</div>

<%- include ("../partials/footer.ejs") %>

  <!-- <div id="location-error-modal" class="modal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h6 class="fw-bold modal-title">WHERE ARE YOU, THE NORTH POLE?</h6>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
          <p>Looks like you're not at the party. 
  Reach out to us for the address
  Jake: 678-736-1277</p>
        </div>
        <div class="modal-footer justify-content-center">
            <a class="xmas-button order-cell-small" href="sms:6787361277&body=drink4thekids%20Christmas%20party%20address%3F">Text Jake</a></p>
        </div>
      </div>
    </div>
  </div> -->

  <div id="date-error-modal" class="modal fade" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="fw-bold green">SON OF A NUTCRACKER</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <p class="fs-3">IT ISN'T PARTY TIME YET <br><br><b class="fw-bold">Saturday, December 17th</b> <br> Mark your calendar</p>
          </div>
          <img class="m-auto" width="180" height="160" src="images/buddy.png" alt="buddy">
          <div class="modal-footer justify-content-center">
              <a class="xmas-button order-cell-small" href="sms:6787361277&body=drink4thekids%20Christmas%20party%20address%3F">Text Jake 4 Address</a></p>
          </div>
        </div>
      </div>
    </div>

</body>
</html>